# Сессионная Аутентификация

## Описание подхода

Эта реализация использует **сессионную аутентификацию** с серверными сессиями, хранящимися в Redis. После успешного входа пользователя на сервере создается сессия, которая идентифицируется через cookie в браузере клиента.

### Особенности:
- **Stateful**: сессии хранятся на сервере
- **Безопасность**: HttpOnly cookies защищают от XSS
- **Масштабируемость**: Redis позволяет масштабировать на несколько серверов
- **Автоматическое истечение**: сессии имеют время жизни

## Технологии

- **Flask** - веб-фреймворк
- **Flask-Session** - управление сессиями
- **Redis** - хранилище сессий
- **bcrypt** - хеширование паролей
- **SQLite** - база данных пользователей

## Установка и запуск

1. Создайте виртуальное окружение:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate     # Windows
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Запустите Redis сервер:
```bash
# Ubuntu/Debian
sudo apt-get install redis-server
sudo systemctl start redis

# macOS с Homebrew
brew install redis
brew services start redis

# Windows - скачайте Redis с официального сайта
```

4. Запустите приложение:
```bash
python main.py
```

5. Откройте браузер: http://localhost:5000

## Использование

### Веб-интерфейс
Откройте http://localhost:5000 в браузере и используйте формы для:
- Регистрации нового пользователя
- Входа в систему
- Просмотра профиля (только для авторизованных)
- Выхода из системы

### API через curl

#### Регистрация:
```bash
curl -X POST http://localhost:5000/register \
  -d "email=user@example.com" \
  -d "password=password123" \
  -c cookies.txt
```

#### Вход:
```bash
curl -X POST http://localhost:5000/login \
  -d "email=user@example.com" \
  -d "password=password123" \
  -c cookies.txt
```

#### Профиль (требует авторизации):
```bash
curl http://localhost:5000/profile \
  -b cookies.txt
```

#### Выход:
```bash
curl -X POST http://localhost:5000/logout \
  -b cookies.txt \
  -c cookies.txt
```

## Безопасность

- **Хеширование паролей**: bcrypt с солью
- **HttpOnly cookies**: защита от XSS
- **Secure cookies**: в продакшене используйте HTTPS
- **SameSite=Lax**: защита от CSRF
- **Время жизни сессий**: 24 часа
- **Валидация входных данных**: проверка email и длины пароля

## Архитектура

```
Клиент (Браузер)
    ↓ HTTP запросы с cookies
Flask приложение
    ↓ проверка сессии
Redis (сессии)
    ↓ проверка пользователя
SQLite (пользователи)
```

## Преимущества сессионной аутентификации

1. **Простота отзыва**: можно мгновенно отозвать сессию
2. **Безопасность**: токены не хранятся на клиенте
3. **Контроль**: полный контроль над активными сессиями
4. **Статистика**: можно отслеживать активных пользователей

## Недостатки

1. **Stateful**: требует хранения состояния на сервере
2. **Масштабируемость**: нужен общий Redis для кластера
3. **Производительность**: дополнительные запросы к Redis
4. **Сложность**: требует настройки Redis
